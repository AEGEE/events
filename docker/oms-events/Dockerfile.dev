FROM node:8

RUN npm install -g --loglevel warn pm2 bunyan && \
	npm cache clean --force

RUN mkdir -p /usr/app/src \
	&& mkdir -p /usr/app/media \
	&& mkdir -p /usr/app/scripts

WORKDIR /usr/app/src

ADD ./bootstrap.sh /usr/app/scripts/bootstrap.sh

CMD sh /usr/app/scripts/bootstrap.sh && \
	pm2 start pm2config.json && \
	pm2 logs --raw | bunyan

EXPOSE 8082
